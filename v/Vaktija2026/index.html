<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Moschee Display</title>

<style>
:root{
  --bg:#ffffff;
  --text:#111827;
  --muted:#6b7280;
  --line:#e5e7eb;
  --accent:#16a34a;   /* gr√ºn */
  --accent2:#dcfce7;  /* hellgr√ºn */
}

*{ box-sizing:border-box; }

body{
  margin:0;
  background:var(--bg);
  color:var(--text);
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  overflow:hidden;
}

/* Header */
#top{
  display:flex;
  justify-content:space-between;
  align-items:flex-end;
  gap:24px;
  padding:26px 40px 14px;
  border-bottom:1px solid var(--line);
}

#leftHeader{
  display:flex;
  align-items:center;
  gap:18px;
  min-width: 420px;
}

#clockBlock{
  display:flex;
  flex-direction:column;
  gap:6px;
}

#digitalClock{
  font-size:86px;
  font-weight:850;
  letter-spacing:-1px;
  line-height:0.95;
}

#secondsSmall{
  font-size:20px;
  color:var(--muted);
  margin-left:2px;
}

#date{
  font-size:26px;
  color:var(--muted);
  text-align:right;
}

#title{
  padding:18px 40px 6px;
  font-size:44px;
  font-weight:780;
  letter-spacing:-0.5px;
  color:var(--accent);
}

#subtitle{
  padding:0 40px 16px;
  font-size:22px;
  color:var(--muted);
}

/* Prayer cards */
#prayers{
  display:grid;
  grid-template-columns: repeat(5, 1fr);
  gap:18px;
  padding:0 40px;
}

.prayer-card{
  background:#fff;
  border:1px solid var(--line);
  border-radius:16px;
  padding:18px;
  box-shadow:0 1px 0 rgba(0,0,0,0.03);
  min-height:120px;
}

.prayer-top{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:10px;
}

.prayer-name{
  font-size:22px;
  color:var(--muted);
}

.badge{
  font-size:14px;
  padding:4px 10px;
  border-radius:999px;
  background:var(--accent2);
  color:var(--accent);
  border:1px solid rgba(22,163,74,0.25);
  display:none;
}

.prayer-time{
  font-size:46px;
  font-weight:850;
  letter-spacing:-0.5px;
}

.prayer-sub{
  margin-top:8px;
  font-size:16px;
  color:var(--muted);
}

.prayer-card.is-next{
  border-color:rgba(22,163,74,0.55);
  box-shadow:0 0 0 3px rgba(22,163,74,0.12);
}
.prayer-card.is-next .badge{ display:inline-block; }

/* Slideshow */
#slideshow{
  padding:18px 40px 0;
  text-align:center;
}
#slideshow img{
  max-height:360px;
  max-width:100%;
  border-radius:16px;
  border:1px solid var(--line);
}

/* Ticker */
#ticker{
  position:fixed;
  bottom:0;
  width:100%;
  background:#f9fafb;
  border-top:1px solid var(--line);
  color:var(--text);
  font-size:26px;
  white-space:nowrap;
  overflow:hidden;
}
#ticker span{
  display:inline-block;
  padding:14px 40px;
  padding-left:100%;
  animation:scroll 28s linear infinite;
}
#ticker b{ color:var(--accent); }
@keyframes scroll{
  from { transform: translateX(0); }
  to   { transform: translateX(-100%); }
}

/* Analog clock */
#analogClock{
  width:120px;
  height:120px;
}
</style>
</head>

<body>

<div id="top">
  <div id="leftHeader">
    <!-- Analog -->
    <svg id="analogClock" viewBox="0 0 200 200" aria-label="Uhr">
      <circle cx="100" cy="100" r="92" fill="#fff" stroke="#e5e7eb" stroke-width="4"/>
      <g id="minuteMarks" stroke="#d1d5db" stroke-width="2"></g>
      <g stroke="#111827" stroke-width="3">
        <line x1="100" y1="18" x2="100" y2="30"/>
        <line x1="100" y1="170" x2="100" y2="182"/>
        <line x1="18" y1="100" x2="30" y2="100"/>
        <line x1="170" y1="100" x2="182" y2="100"/>
      </g>
      <line id="hourHand" x1="100" y1="100" x2="100" y2="58" stroke="#111827" stroke-linecap="round" stroke-width="6"/>
      <line id="minHand"  x1="100" y1="100" x2="100" y2="40" stroke="#111827" stroke-linecap="round" stroke-width="4"/>
      <line id="secHand"  x1="100" y1="104" x2="100" y2="30" stroke="#16a34a" stroke-linecap="round" stroke-width="2"/>
      <circle cx="100" cy="100" r="4" fill="#16a34a"/>
    </svg>

    <!-- Digital -->
    <div id="clockBlock">
      <div id="digitalClock">--:-- <span id="secondsSmall">--</span></div>
    </div>
  </div>

  <div id="date">--</div>
</div>

<div id="title">Gebetszeiten</div>
<div id="subtitle" id="subtitleText">Heute ‚Ä¢ automatisch berechnet</div>

<div id="prayers">
  <div class="prayer-card" id="card-fajr">
    <div class="prayer-top">
      <div class="prayer-name">Fajr</div>
      <div class="badge">N√ÑCHSTES</div>
    </div>
    <div class="prayer-time" id="fajr">--:--</div>
    <div class="prayer-sub" id="fajrSub"></div>
  </div>

  <div class="prayer-card" id="card-dhuhr">
    <div class="prayer-top">
      <div class="prayer-name">Dhuhr</div>
      <div class="badge">N√ÑCHSTES</div>
    </div>
    <div class="prayer-time" id="dhuhr">--:--</div>
    <div class="prayer-sub" id="dhuhrSub"></div>
  </div>

  <div class="prayer-card" id="card-asr">
    <div class="prayer-top">
      <div class="prayer-name">Asr</div>
      <div class="badge">N√ÑCHSTES</div>
    </div>
    <div class="prayer-time" id="asr">--:--</div>
    <div class="prayer-sub" id="asrSub"></div>
  </div>

  <div class="prayer-card" id="card-maghrib">
    <div class="prayer-top">
      <div class="prayer-name">Maghrib</div>
      <div class="badge">N√ÑCHSTES</div>
    </div>
    <div class="prayer-time" id="maghrib">--:--</div>
    <div class="prayer-sub" id="maghribSub"></div>
  </div>

  <div class="prayer-card" id="card-isha">
    <div class="prayer-top">
      <div class="prayer-name">Isha</div>
      <div class="badge">N√ÑCHSTES</div>
    </div>
    <div class="prayer-time" id="isha">--:--</div>
    <div class="prayer-sub" id="ishaSub"></div>
  </div>
</div>

<div id="slideshow">
  <img id="slide" alt="Info" />
</div>

<div id="ticker">
  <span>
    <b>üïå</b> Willkommen ‚Ä¢ <b>üì¢</b> Unterricht freitags nach Jumuah ‚Ä¢ <b>ü§ù</b> Unterst√ºtzt unsere Moschee ‚Ä¢
    Werbung: Firma XYZ ‚Äì Danke f√ºr eure Unterst√ºtzung
  </span>
</div>

<script>
// ========= EINSTELLUNGEN =========
// Gebetszeiten √ºber Aladhan (kostenlos)
const CITY    = "Vienna";      // <-- HIER √ÑNDERN (z.B. "Vienna" / "Wien")
const COUNTRY = "Austria";     // <-- HIER √ÑNDERN
const METHOD  = 3;             // 3 = Muslim World League (MWL). Andere Methoden m√∂glich.

// Slides (Bilder) ‚Äì lege diese Dateien in einen Ordner "slides" neben index.html
const SLIDES = [
  "slides/ayet1.jpg",
  "slides/info1.jpg",
  "slides/werbung1.jpg"
];
const SLIDE_SECONDS = 15;      // alle 15s wechseln

// Zeitzone fix (f√ºr TV/Browser)
const TZ = "Europe/Vienna";

// ========= HELPERS =========
function pad2(n){ return String(n).padStart(2,"0"); }

function nowParts(){
  // sichere Ausgabe f√ºr Zeitzone
  const parts = new Intl.DateTimeFormat('en-CA', {
    timeZone: TZ, year:'numeric', month:'2-digit', day:'2-digit',
    hour:'2-digit', minute:'2-digit', second:'2-digit', hour12:false
  }).formatToParts(new Date());
  const get = (t)=>parts.find(p=>p.type===t).value;
  return { y:get('year'), mo:get('month'), d:get('day'), hh:get('hour'), mm:get('minute'), ss:get('second') };
}

function todayISO(){
  const p = nowParts();
  return ${p.y}-${p.mo}-${p.d}; // YYYY-MM-DD
}

function minutesFromHHMM(hhmm){
  const [hh, mm] = hhmm.split(":").map(Number);
  return hh*60 + mm;
}

// ========= ANALOG CLOCK (SVG) =========
(function buildMinuteMarks(){
  const g = document.getElementById("minuteMarks");
  for(let k=0;k<12;k++){
    const a = (k*30) * Math.PI/180;
    const r1 = 84, r2 = 92;
    const x1 = 100 + r1*Math.sin(a);
    const y1 = 100 - r1*Math.cos(a);
    const x2 = 100 + r2*Math.sin(a);
    const y2 = 100 - r2*Math.cos(a);
    const line = document.createElementNS("http://www.w3.org/2000/svg","line");
    line.setAttribute("x1", x1); line.setAttribute("y1", y1);
    line.setAttribute("x2", x2); line.setAttribute("y2", y2);
    g.appendChild(line);
  }
})();

function updateClocks(){
  const p = nowParts();

  // Digital
  document.getElementById("digitalClock").firstChild.textContent = `${p.hh}:${p.mm} `;
  document.getElementById("secondsSmall").textContent = p.ss;

  // Date (German)
  const dateStr = new Intl.DateTimeFormat('de-DE', {
    timeZone: TZ, weekday:'long', day:'numeric', month:'long', year: undefined
  }).format(new Date());
  document.getElementById("date").innerText = dateStr;

  // Analog
  const sec = Number(p.ss);
  const min = Number(p.mm);
  const hr  = Number(p.hh) % 12;

  const secDeg = sec * 6;
  const minDeg = (min + sec/60) * 6;
  const hrDeg  = (hr + min/60) * 30;

  document.getElementById("secHand").setAttribute("transform", rotate(${secDeg} 100 100));
  document.getElementById("minHand").setAttribute("transform", rotate(${minDeg} 100 100));
  document.getElementById("hourHand").setAttribute("transform", rotate(${hrDeg} 100 100));
}
setInterval(updateClocks, 1000);
updateClocks();

// ========= PRAYER TIMES (API) =========
async function loadPrayers(){
  const url = https://api.aladhan.com/v1/timingsByCity?city=${encodeURIComponent(CITY)}&country=${encodeURIComponent(COUNTRY)}&method=${METHOD};
  const res = await fetch(url, { cache: "no-store" });
  const data = await res.json();
  const t = data.data.timings;

  // Wir nutzen die Hauptzeiten
  const timings = {
    Fajr: t.Fajr,
    Dhuhr: t.Dhuhr,
    Asr: t.Asr,
    Maghrib: t.Maghrib,
    Isha: t.Isha
  };

  // Anzeigen
  document.getElementById("fajr").innerText = timings.Fajr;
  document.getElementById("dhuhr").innerText = timings.Dhuhr;
  document.getElementById("asr").innerText = timings.Asr;
  document.getElementById("maghrib").innerText = timings.Maghrib;
  document.getElementById("isha").innerText = timings.Isha;

  // Subline: Ort/Quelle
  document.getElementById("subtitleText").innerText = Heute ‚Ä¢ ${CITY}, ${COUNTRY} ‚Ä¢ automatisch berechnet;

  // Next prayer markieren
  markNextPrayer(timings);

  // alle 60 Minuten neu laden (f√ºr Datumwechsel / Stabilit√§t)
  setTimeout(loadPrayers, 60*60*1000);
}

function markNextPrayer(timings){
  const order = ["Fajr","Dhuhr","Asr","Maghrib","Isha"];
  const cards = {
    Fajr:"card-fajr",
    Dhuhr:"card-dhuhr",
    Asr:"card-asr",
    Maghrib:"card-maghrib",
    Isha:"card-isha"
  };

  // reset
  Object.values(cards).forEach(id => document.getElementById(id).classList.remove("is-next"));

  // jetzt
  const p = nowParts();
  const nowMin = Number(p.hh)*60 + Number(p.mm);

  // n√§chste Zeit finden
  let nextName = null;
  for(const name of order){
    const m = minutesFromHHMM(timings[name]);
    if(m >= nowMin){ nextName = name; break; }
  }
  if(!nextName) nextName = "Fajr"; // nach Isha => Fajr morgen

  document.getElementById(cards[nextName]).classList.add("is-next");
}

loadPrayers();

// ========= SLIDESHOW =========
let slideIndex = 0;
function showSlide(){
  const img = document.getElementById("slide");
  img.src = SLIDES[slideIndex % SLIDES.length];
  slideIndex++;
}
showSlide();
setInterval(showSlide, SLIDE_SECONDS*1000);
</script>

</body>
</html>